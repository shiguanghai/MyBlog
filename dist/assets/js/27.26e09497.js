(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{518:function(s,t,n){"use strict";n.r(t);var a=n(1),e=Object(a.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"_4-1-准备工作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-准备工作"}},[s._v("#")]),s._v(" 4.1 准备工作")]),s._v(" "),n("h3",{attrs:{id:"vue-源码获取"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue-源码获取"}},[s._v("#")]),s._v(" Vue 源码获取")]),s._v(" "),n("ul",[n("li",[s._v("项目地址 "),n("a",{attrs:{href:"https://github.com/vuejs/vue",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/vuejs/vue"),n("OutboundLink")],1)]),s._v(" "),n("li",[s._v("Fork 一份到自己仓库，克隆到本地，可以自己写注释提交到 github")]),s._v(" "),n("li",[s._v("为什么分析 Vue 2.6\n"),n("ul",[n("li",[s._v("到目前为止 Vue 3.0 的正式版还没有发布")]),s._v(" "),n("li",[s._v("新版本发布后，现有项目不会升级到 3.0，2.x 还有很长的一段过渡期")]),s._v(" "),n("li",[s._v("3.0 项目地址："),n("a",{attrs:{href:"https://github.com/vuejs/vue-next",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/vuejs/vue-next"),n("OutboundLink")],1)])])])]),s._v(" "),n("blockquote",[n("p",[n("strong",[s._v("可以参考我 Fork 的"),n("a",{attrs:{href:"https://github.com/shiguanghai/vue",target:"_blank",rel:"noopener noreferrer"}},[s._v("源码"),n("OutboundLink")],1)]),s._v("，相较官网增加了一些额外的代码批注以及部分官方注释的翻译，文章未展示到的代码可以自己深入来看，另外用到"),n("a",{attrs:{href:"https://github.com/shiguanghai/vue/tree/dev/examples",target:"_blank",rel:"noopener noreferrer"}},[s._v("案例"),n("OutboundLink")],1),s._v("也可以在其中获取")])]),s._v(" "),n("h3",{attrs:{id:"源码目录结构"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#源码目录结构"}},[s._v("#")]),s._v(" 源码目录结构")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("src\n├─compiler   编译相关 \n├─core    Vue 核心库（与平台无关的代码）\n│ components 定义 vue 自带的 keep"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("alive 组件\n│ global"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("api 定义 vue 静态方法\n│ instance 创建 vue 实例（构造函数、初始化、生命周期函数）\n│ observer 响应式机制实现（本章重点）\n│ util  公共成员\n│ vdom  虚拟dom\n├─platforms  平台相关代码\n│ web   \n│ weex  基于vue移动端框架\n├─server   "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SSR")]),s._v("，服务端渲染\n├─sfc    单文件组件（"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("vue 文件编译为 js 对象）\n└─shared   公共的代码\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("p",[s._v("我们可以看到，Vue 在开发的时候首先会按照"),n("strong",[s._v("功能")]),s._v("把代码拆分到"),n("strong",[s._v("不同的文件夹")]),s._v("，然后再拆分成小的"),n("strong",[s._v("模块")]),s._v("，这样的代码结构清楚，可以提高其"),n("strong",[s._v("可读性")]),s._v("和"),n("strong",[s._v("可维护性")]),s._v("。")]),s._v(" "),n("h3",{attrs:{id:"调试设置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#调试设置"}},[s._v("#")]),s._v(" 调试设置")]),s._v(" "),n("p",[n("strong",[s._v("打包")]),s._v(".")]),s._v(" "),n("ul",[n("li",[s._v("打包工具 Rollup\n"),n("ul",[n("li",[s._v("Vue.js 源码的打包工具使用的是 Rollup，比 Webpack 轻量")]),s._v(" "),n("li",[s._v("Webpack 把所有文件当做模块，Rollup 只处理 js 文件更适合在 Vue.js 这样的库中使用")]),s._v(" "),n("li",[s._v("Rollup 打包不会生成冗余的代码")]),s._v(" "),n("li",[s._v("详细可见 "),n("a",{attrs:{href:"https://shiguanghai.top/blogs/%E5%A4%A7%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96%E5%AE%9E%E6%88%98/Rollup%E3%80%81Parcel%20%E6%89%93%E5%8C%85.html#_6-1-rollup-%E6%89%93%E5%8C%85",target:"_blank",rel:"noopener noreferrer"}},[s._v("Rollup 打包"),n("OutboundLink")],1)])])])]),s._v(" "),n("p",[s._v("安装依赖")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" i\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("设置 sourcemap")]),s._v(" "),n("ul",[n("li",[s._v("package.json 文件中的 dev 脚本中添加参数 --sourcemap 开启代码地图")])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dev"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rollup -w -c scripts/config.js --sourcemap --environment TARGET:webfull-dev"')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ul",[n("li",[s._v("执行 dev\n"),n("ul",[n("li",[s._v("首先我们先将 "),n("code",[s._v("dist")]),s._v(" 目录删除，以便看得更清楚")]),s._v(" "),n("li",[n("code",[s._v("npm run dev")]),s._v(" 执行打包，用的是 rollup，-w 参数是监听文件的变化，文件变化自动重新打包；-c 是设置配置文；最后一个参数是配置环境变量，从而来打包生成不同版本的 vue")]),s._v(" "),n("li",[n("strong",[s._v("注意")]),s._v("：Window 系统的朋友可能会遇到一个问题：")])])])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201205154633545.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}}),s._v("\n在这里，我初次从 github 将 vue 源代码 clone 下来，"),n("code",[s._v("npm i")]),s._v(" 安装依赖之后执行 "),n("code",[s._v("npm run dev")]),s._v(" 打包报出如上错误，而当我们查看文件我们发现并没有创建 dist 目录，这个错误大致的意思是找不到你的某个文件（文件不一定，之前遇到过core/index文件找不到）")]),s._v(" "),n("p",[s._v("我猜想这是因为 "),n("strong",[s._v("rollup")]),s._v(" 打包使用 "),n("strong",[s._v("rollup-plugin-alias")]),s._v(" 来处理一些常用的公共路径。但是在 win 环境下，这个别名的解析好像工作不正常，文件缺少了.js后缀导致识别不到文件，最简单的方式是下载 "),n("a",{attrs:{href:"https://github.com/ideayuye/rollup-plugin-alias",target:"_blank",rel:"noopener noreferrer"}},[s._v("此版本的 rollup-plugin-alias"),n("OutboundLink")],1),s._v(" 并覆盖原文件，具体操作过程如下：")]),s._v(" "),n("ul",[n("li",[s._v("clone "),n("a",{attrs:{href:"https://github.com/ideayuye/rollup-plugin-alias",target:"_blank",rel:"noopener noreferrer"}},[s._v("仓库源码"),n("OutboundLink")],1),s._v(" 到本地")]),s._v(" "),n("li",[n("code",[s._v("npm i")]),s._v(" 安装依赖")]),s._v(" "),n("li",[n("code",[s._v("npm run build")]),s._v(" 编译")]),s._v(" "),n("li",[s._v("将编译后的 "),n("code",[s._v("src/index.js")]),s._v(" 与 "),n("code",[s._v("dist/rollup-plugin-alias.es2015.js")]),s._v(" 与 "),n("code",[s._v("dist/rollup-plugin-alias.js")]),s._v(" 文件替换你从 vue 官网克隆下来的代码里 "),n("code",[s._v("node_modules/rollup-plugin-alias")]),s._v(" 中的"),n("code",[s._v("src")]),s._v(" 和 "),n("code",[s._v("dist")]),s._v(" 内的内容")]),s._v(" "),n("li",[s._v("如果你感兴趣可以对比下"),n("a",{attrs:{href:"https://gitee.com/shiguanghaitop/big-front-end-phase-5/tree/master/fed-e-task-03-02/code/rollup-plugin-alias",target:"_blank",rel:"noopener noreferrer"}},[s._v("二者的代码"),n("OutboundLink")],1)]),s._v(" "),n("li",[s._v("此时再次运行 "),n("code",[s._v("nom run dev")]),s._v(" 打包vue源码，如下图所示就证明打包成功了")])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/2020120516023619.png",alt:"在这里插入图片描述"}}),s._v("\n此时 dist 目录重新生成内容如下，新增了 vue.js 和 vue.js.map")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201205160849737.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}}),s._v("\n至于其他版本的js文件我们后续可以通过调用 "),n("code",[s._v("npm run build")]),s._v(" 得到")]),s._v(" "),n("p",[n("strong",[s._v("调试")]),s._v(".")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201208215140578.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),n("ul",[n("li",[s._v("examples 的示例中引入的 vue.min.js 改为 vue.js")]),s._v(" "),n("li",[s._v("打开 Chrome 的调试工具中的 source")]),s._v(" "),n("li",[s._v("此时就可以看到源文件了")])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201208215355426.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),n("h3",{attrs:{id:"vue-的不同构建版本"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue-的不同构建版本"}},[s._v("#")]),s._v(" Vue 的不同构建版本")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("npm run build")]),s._v(" 重新打包所有文件")])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201208215728699.png",alt:"在这里插入图片描述"}})]),s._v(" "),n("ul",[n("li",[s._v("官方文档 - "),n("a",{attrs:{href:"https://cn.vuejs.org/v2/guide/installation.html#%E5%AF%B9%E4%B8%8D%E5%90%8C%E6%9E%84%E5%BB%BA%E7%89%88%E6%9C%AC%E7%9A%84%E8%A7%A3%E9%87%8A",target:"_blank",rel:"noopener noreferrer"}},[s._v("对不同构建版本的解释"),n("OutboundLink")],1)]),s._v(" "),n("li",[s._v("dist/README.md")])]),s._v(" "),n("table",[n("thead",[n("tr",[n("th"),s._v(" "),n("th",[s._v("UMD")]),s._v(" "),n("th",[s._v("CommonJS")]),s._v(" "),n("th",[s._v("ES Module")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[n("strong",[s._v("Full")])]),s._v(" "),n("td",[s._v("vue.js")]),s._v(" "),n("td",[s._v("vue.common.js")]),s._v(" "),n("td",[s._v("vue.esm.js")])]),s._v(" "),n("tr",[n("td",[n("strong",[s._v("Runtime-only")])]),s._v(" "),n("td",[s._v("vue.runtime.js")]),s._v(" "),n("td",[s._v("vue.runtime.common.js")]),s._v(" "),n("td",[s._v("vue.runtime.esm.js")])]),s._v(" "),n("tr",[n("td",[n("strong",[s._v("Full (production)")])]),s._v(" "),n("td",[s._v("vue.min.js")]),s._v(" "),n("td"),s._v(" "),n("td")]),s._v(" "),n("tr",[n("td",[n("strong",[s._v("Runtime-only (production)")])]),s._v(" "),n("td",[s._v("vue.runtime.min.js")]),s._v(" "),n("td"),s._v(" "),n("td")])])]),s._v(" "),n("p",[n("strong",[s._v("术语")]),s._v(".")]),s._v(" "),n("ul",[n("li",[n("strong",[s._v("完整版")]),s._v("：同时包含"),n("strong",[s._v("编译器")]),s._v("和"),n("strong",[s._v("运行时")]),s._v("的版本")]),s._v(" "),n("li",[n("strong",[s._v("编译器")]),s._v("：用来将模板字符串编译成为 JavaScript 渲染函数的代码，体积大、效率低")]),s._v(" "),n("li",[n("strong",[s._v("运行时")]),s._v("：用来创建 Vue 实例、渲染并处理虚拟 DOM 等的代码，体积小、效率高。基本上就是除去编译器的代码")]),s._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/umdjs/umd",target:"_blank",rel:"noopener noreferrer"}},[s._v("UMD"),n("OutboundLink")],1),s._v("：UMD 版本通用的模块版本，支持多种模块方式。 vue.js 默认文件就是运行时 + 编译器的UMD 版本")]),s._v(" "),n("li",[n("a",{attrs:{href:"http://wiki.commonjs.org/wiki/Modules/1.1",target:"_blank",rel:"noopener noreferrer"}},[s._v("CommonJS"),n("OutboundLink")],1),s._v("(cjs)：CommonJS 版本用来配合老的打包工具比如 "),n("a",{attrs:{href:"http://browserify.org/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Browserify"),n("OutboundLink")],1),s._v(" 或 "),n("a",{attrs:{href:"https://webpack.github.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("webpack 1"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"http://exploringjs.com/es6/ch_modules.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("ES Module"),n("OutboundLink")],1),s._v("：从 2.6 开始 Vue 会提供两个 ES Modules (ESM) 构建文件，为现代打包工具提供的版本\n"),n("ul",[n("li",[s._v("ESM 格式被设计为可以被静态分析，所以打包工具可以利用这一点来进行“tree-shaking”并将用不到的代码排除出最终的包")]),s._v(" "),n("li",[n("a",{attrs:{href:"https://es6.ruanyifeng.com/#docs/module-loader#ES6-%E6%A8%A1%E5%9D%97%E4%B8%8E-CommonJS-%E6%A8%A1%E5%9D%97%E7%9A%84%E5%B7%AE%E5%BC%82",target:"_blank",rel:"noopener noreferrer"}},[s._v("ES6 模块与 CommonJS 模块的差异"),n("OutboundLink")],1)])])])]),s._v(" "),n("p",[n("strong",[s._v("Runtime + Compiler vs. Runtime-only")]),s._v(".")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// <script src="../../dist/vue.js"><\/script>')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Compiler")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 需要编译器，把 template 转换成 render 函数")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" vm "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Vue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  el"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'#app'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  template"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'<h1>{{ msg }}</h1>'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  data"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    msg"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Hello Vue'")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// <script src="../../dist/vue.runtime.js"><\/script>')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Runtime")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 不需要编译器")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" vm "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Vue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  el"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'#app'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// template: '<h1>{{ msg }}</h1>',")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("render")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("h")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("h")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'h1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  data"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    msg"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Hello Vue'")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("ul",[n("li",[s._v("推荐使用运行时版本，因为运行时版本相比完整版体积要小大约 30%")]),s._v(" "),n("li",[s._v("基于 Vue-CLI 创建的项目默认使用的是 "),n("code",[s._v("vue.runtime.esm.js")])])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// src/main.js")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Vue "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'vue'")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("ul",[n("li",[s._v("通过查看 webpack 的配置文件\n"),n("ul",[n("li",[s._v("终端输入")])])])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("vue inspect "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" output.js\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// output.js")]),s._v("\n  resolve"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    alias"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n   vue$"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'vue/dist/vue.runtime.esm.js'")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("ul",[n("li",[n("strong",[s._v("注意")]),s._v("： "),n("code",[s._v("*.vue")]),s._v(" 文件中的模板是在构建时预编译的，最终打包后的结果不需要编译器，只需要运行时版本即可")])]),s._v(" "),n("h3",{attrs:{id:"寻找入口文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#寻找入口文件"}},[s._v("#")]),s._v(" 寻找入口文件")]),s._v(" "),n("ul",[n("li",[s._v("查看 dist/vue.js 的构建过程")])]),s._v(" "),n("p",[n("strong",[s._v("执行构建")]),s._v(".")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" run dev\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# "dev": "rollup -w -c scripts/config.js --sourcemap --environment TARGET:web-full-dev"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --environment TARGET:web-full-dev 设置环境变量 TARGET")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("ul",[n("li",[n("code",[s._v("script/config.js")]),s._v(" 的执行过程（文件末尾）\n"),n("ul",[n("li",[s._v("作用：生成 rollup 构建的配置文件")]),s._v(" "),n("li",[s._v("使用环境变量 TARGET = web-full-dev")])])])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 判断环境变量是否有 TARGET")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 如果有的话 使用 genConfig() 生成 rollup 配置文件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TARGET")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  module"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("genConfig")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TARGET")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 否则获取全部配置")]),s._v("\n  exports"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("getBuild "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" genConfig\n  exports"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("getAllBuilds")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" Object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("keys")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("builds"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("map")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("genConfig"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("ul",[n("li",[s._v("genConfig(name)\n"),n("ul",[n("li",[s._v("根据环境变量 TARGET 获取配置信息")]),s._v(" "),n("li",[n("code",[s._v("const opts = builds[name]")])]),s._v(" "),n("li",[s._v("builds[name] 获取生成配置的信息")])])])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" builds "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Runtime+compiler development build (Browser)")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'web-full-dev'")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 入口")]),s._v("\n    entry"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'web/entry-runtime-with-compiler.js'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    dest"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'dist/vue.js'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    format"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'umd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    env"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'development'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    alias"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" he"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./entity-decoder'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    banner\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("ul",[n("li",[s._v("resolve()\n"),n("ul",[n("li",[s._v("获取入口和出口文件的绝对路径")])])])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" aliases "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./alias'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("resolve")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("p")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 根据路径中的前半部分去alias中找别名")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" base "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" p"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("split")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("aliases"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("base"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("aliases"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("base"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" p"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("slice")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("base"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("length "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'../'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" p"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// scripts/alias")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" path "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'path'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("resolve")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("p")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'../'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" p"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nmodule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n  web"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'src/platforms/web'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("p",[n("strong",[s._v("结果")]),s._v(".")]),s._v(" "),n("ul",[n("li",[s._v("把 src/platforms/web/entry-runtime-with-compiler.js 构建成 dist/vue.js，如果设置 --sourcemap 会生成 vue.js.map")]),s._v(" "),n("li",[s._v("src/platform 文件夹下是 Vue 可以构建成不同平台下使用的库，目前有 weex 和 web，还有服务器端渲染的库")])]),s._v(" "),n("h3",{attrs:{id:"从入口开始"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#从入口开始"}},[s._v("#")]),s._v(" 从入口开始")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/src/platforms/web/entry-runtime-with-compiler.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("src/platforms/web/entry-runtime-with-compiler.js"),n("OutboundLink")],1)])]),s._v(" "),n("p",[n("strong",[s._v("观察"),n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/examples/02-debug/index.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("以下代码"),n("OutboundLink")],1),s._v("，通过阅读源码，回答在页面上输出的结果")])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" vm "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Vue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  el"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'#app'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  template"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'<h1>Hello Template</h1>'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("render")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("h")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("h")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'h1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Hello Render'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("ul",[n("li",[s._v("阅读源码记录\n"),n("ul",[n("li",[s._v("el 不能是 body 或者 html 标签")]),s._v(" "),n("li",[s._v("如果没有 render，把 template 转换成 render 函数")]),s._v(" "),n("li",[s._v("如果有 render 方法，直接调用 mount 挂载 DOM")])])])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 保留 Vue 实例的 $mount 方法")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" mount "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Vue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("prototype"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("$mount\n"),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Vue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("prototype"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("$mount")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  el"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" string "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Element"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 非ssr情况下为 false，ssr 时候为true")]),s._v("\n  hydrating"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" boolean\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Component "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 获取 el 对象")]),s._v("\n  el "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" el "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("query")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* istanbul ignore if */")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// el 不能是 body 或者 html")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("el "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("body "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" el "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("documentElement"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NODE_ENV")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'production'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("warn")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("Do not mount Vue to <html> or <body> - mount to normal elements instead.")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" options "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("$options\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// resolve template/el and convert to render function")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 把 template/el 转换成 render 函数")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("render"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 调用 mount 方法，渲染 DOM")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mount")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("call")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" hydrating"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br")])]),n("blockquote",[n("p",[s._v("抛出问题：$mount 是谁调用的? 又是在什么位置？")])]),s._v(" "),n("ul",[n("li",[s._v("调试代码的方法")])]),s._v(" "),n("p",[s._v("注意：如果你最后执行了 "),n("code",[s._v("npm run build")]),s._v("操作，disy/vue.js 中的最后一行的 sourceMap 映射 "),n("code",[s._v("//# sourceMappingURL=vue.js.map")]),s._v(" 会被清除，所以如果想在调试过程看到 src 源码，需要重新 "),n("code",[s._v("npm run dev")]),s._v(" 开启代码地图。")]),s._v(" "),n("ul",[n("li",[s._v("调试代码"),n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/examples/02-debug/index.html",target:"_blank",rel:"noopener noreferrer"}},[n("code",[s._v("examples/02-debug/index.html")]),n("OutboundLink")],1)])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201205181754168.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}}),s._v("\n在调用堆栈位置，我们可以看到方法调用的过程，当前执行的是 "),n("code",[s._v("Vue.$mount")]),s._v(" 方法，再往下可以看到 "),n("code",[s._v("Vue._init")])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201209200109284.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}}),s._v("\nVue 构造函数\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201209200724907.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),n("p",[s._v("从而我们得知："),n("strong",[n("code",[s._v("$mount")]),s._v(" 是 "),n("code",[s._v("_init()")]),s._v(" 调用的")])]),s._v(" "),n("p",[s._v("同时也验证了开始的答案："),n("strong",[s._v("如果 "),n("code",[s._v("new Vue")]),s._v(" 同时设置了 "),n("code",[s._v("template")]),s._v(" 和 "),n("code",[s._v("render()")]),s._v(" ，此时只会执行 "),n("code",[s._v("render()")])])]),s._v(" "),n("blockquote",[n("p",[s._v("Vue 的构造函数在哪？\nVue 实例的成员 / Vue 的静态成员 从哪里来的？")])]),s._v(" "),n("h2",{attrs:{id:"_4-2-vue初始化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-vue初始化"}},[s._v("#")]),s._v(" 4.2 Vue初始化")]),s._v(" "),n("h3",{attrs:{id:"vue-初始化过程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue-初始化过程"}},[s._v("#")]),s._v(" Vue 初始化过程")]),s._v(" "),n("p",[n("strong",[s._v("Vue 的构造函数在哪里")]),s._v(":")]),s._v(" "),n("ul",[n("li",[s._v("src/platform/web/entry-runtime-with-compiler.js 中引用了  './runtime/index'")])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Vue "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./runtime/index'")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ul",[n("li",[n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/src/platforms/web/runtime/index.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("src/platform/web/runtime/index.js"),n("OutboundLink")],1),s._v(" "),n("ul",[n("li",[s._v("设置 Vue.config")]),s._v(" "),n("li",[s._v("设置平台相关的指令和组件\n"),n("ul",[n("li",[s._v("指令 v-model、v-show")]),s._v(" "),n("li",[s._v("组件 transition、transition-group")])])]),s._v(" "),n("li",[s._v("设置平台相关的 __patch__ 方法（打补丁方法，对比新旧的 VNode）")]),s._v(" "),n("li",[n("strong",[s._v("设置 $mount 方法，挂载 DOM")])])])])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" config "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'core/config'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// install platform runtime directives & components")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 设置平台相关的指令和组件(运行时)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// extend() 将第二个参数对象成员 拷贝到 第一个参数对象中去")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 指令 v-model、v-show")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("extend")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("directives"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" platformDirectives"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 组件 transition、transition-group")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("extend")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("components"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" platformComponents"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// install platform patch function")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 设置平台相关的 __patch__ 方法 (虚拟DOM 转换成 真实DOM)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 判断是否是浏览器环境（是 - 直接返回， 非 - 空函数 noop")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Vue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("prototype"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("__patch__ "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" inBrowser "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" patch "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" noop\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// public mount method")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 设置 $mount 方法，挂载 DOM")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Vue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("prototype"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("$mount")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("el"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" string "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Element"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  hydrating"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" boolean")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Component "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  el "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" el "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" inBrowser "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("query")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("undefined")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mountComponent")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" hydrating"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br")])]),n("ul",[n("li",[s._v("src/platform/web/runtime/index.js 中引用了  'core/index'")])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Vue "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'core/index'")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ul",[n("li",[n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/src/core/index.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("src/core/index.js"),n("OutboundLink")],1),s._v(" "),n("ul",[n("li",[s._v("定义了 Vue 的静态方法")]),s._v(" "),n("li",[n("code",[s._v("initGlobalAPI(Vue)")])])])]),s._v(" "),n("li",[s._v("src/core/index.js 中引用了 './instance/index'")])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Vue "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./instance/index'")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ul",[n("li",[n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/src/core/instance/index.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("src/core/instance/index.js"),n("OutboundLink")],1),s._v(" "),n("ul",[n("li",[s._v("定义了 Vue 的构造函数")]),s._v(" "),n("li",[s._v("设置 Vue 实例的成员")])])])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 此处不用 class 的原因是因为方便后续给 Vue 实例混入实例成员")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("Vue")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("options")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NODE_ENV")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'production'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("instanceof")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Vue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("warn")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Vue is a constructor and should be called with the `new` keyword'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 调用 _init() 方法")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("_init")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 注册 vm 的 _init() 方法，初始化 vm")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initMixin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 注册 vm 的 $data/$props/$set/$delete/$watch")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("stateMixin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 初始化事件相关方法")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// $on/$once/$off/$emit")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("eventsMixin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 初始化生命周期相关的混入方法")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// _update/$forceUpdate/$destroy")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("lifecycleMixin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 混入 render")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// $nextTick/_render")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("renderMixin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" Vue\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br")])]),n("h3",{attrs:{id:"整理四个导出-vue-的模块"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#整理四个导出-vue-的模块"}},[s._v("#")]),s._v(" 整理四个导出 Vue 的模块")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/src/platforms/web/entry-runtime-with-compiler.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("src/platforms/web/entry-runtime-with-compiler.js"),n("OutboundLink")],1),s._v(" "),n("ul",[n("li",[s._v("web 平台相关的入口")]),s._v(" "),n("li",[s._v("重写了平台相关的 $mount()方法")]),s._v(" "),n("li",[s._v("注册了 Vue.compile() 方法，传递一个 HTML 字符串返回 render 函数")])])]),s._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/src/platforms/web/runtime/index.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("src/platform/web/runtime/index.js"),n("OutboundLink")],1),s._v(" "),n("ul",[n("li",[s._v("web 平台相关")]),s._v(" "),n("li",[s._v("注册和平台相关的全局指令：v-model、v-show")]),s._v(" "),n("li",[s._v("注册和平台相关的全局组件： v-transition、v-transition-group")]),s._v(" "),n("li",[s._v("全局方法：\n"),n("ul",[n("li",[s._v("__patch__：把虚拟 DOM 转换成真实 DOM")]),s._v(" "),n("li",[s._v("$mount：挂载方法")])])])])]),s._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/src/core/index.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("src/core/index.js"),n("OutboundLink")],1),s._v(" "),n("ul",[n("li",[s._v("与平台无关")]),s._v(" "),n("li",[s._v("设置了 Vue 的静态方法，initGlobalAPI(Vue)")])])]),s._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/src/core/instance/index.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("src/core/instance/index.js"),n("OutboundLink")],1),s._v(" "),n("ul",[n("li",[s._v("与平台无关")]),s._v(" "),n("li",[s._v("定义了构造函数，调用了 this._init(options) 方法")]),s._v(" "),n("li",[s._v("给 Vue 中混入了常用的实例成员")])])])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/2020120518555115.png",alt:"在这里插入图片描述"}})]),s._v(" "),n("h3",{attrs:{id:"vue-静态成员初始化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue-静态成员初始化"}},[s._v("#")]),s._v(" Vue 静态成员初始化")]),s._v(" "),n("p",[s._v("通过 "),n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/src/core/index.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("src/core/index.js"),n("OutboundLink")],1),s._v(" 的 "),n("code",[s._v("initGlobalAPI(Vue)")]),s._v(" 来到 "),n("strong",[s._v("初始化 Vue 的静态方法")]),s._v(" 所在文件")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" initGlobalAPI "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./global-api/index'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 注册 Vue 的静态属性/方法")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initGlobalAPI")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("ul",[n("li",[n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/src/core/global-api/index.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("src/core/global-api/index.js"),n("OutboundLink")],1),s._v(" "),n("ul",[n("li",[s._v("初始化 Vue 的静态方法\n"),n("ul",[n("li",[s._v("initUse() : "),n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/src/core/global-api/use.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("src/core/global-api/use.js"),n("OutboundLink")],1)]),s._v(" "),n("li",[s._v("initMixin() : "),n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/src/core/global-api/mixin.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("src/core/global-api/mixin.js"),n("OutboundLink")],1)]),s._v(" "),n("li",[s._v("initExtend() : "),n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/src/core/global-api/extend.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("src/core/global-api/extend.js"),n("OutboundLink")],1)]),s._v(" "),n("li",[s._v("initAssetRegisters() : "),n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/src/core/global-api/assets.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("src/core/global-api/assets.js"),n("OutboundLink")],1)])])]),s._v(" "),n("li",[s._v("可参考 "),n("a",{attrs:{href:"https://cn.vuejs.org/v2/api/#%E5%85%A8%E5%B1%80-API",target:"_blank",rel:"noopener noreferrer"}},[s._v("Vue 全局 API 文档"),n("OutboundLink")],1)])])])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initGlobalAPI")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("Vue"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" GlobalAPI")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 初始化 Vue.config 对象")]),s._v("\n  Object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("defineProperty")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'config'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" configDef"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// exposed util methods.")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// NOTE: these are not considered part of the public API - avoid relying on")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// them unless you are aware of the risk.")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 这些工具方法不视作全局API的一部分，除非你已经意识到某些风险，否则不要去依赖他们")]),s._v("\n  Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    warn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    extend"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    mergeOptions"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    defineReactive\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 静态方法 set/delete/nextTick")]),s._v("\n  Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("set "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v("\n  Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("delete "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" del\n  Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("nextTick "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" nextTick\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 2.6 explicit observable API")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 让一个对象可响应")]),s._v("\n  Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("observable "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("T")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("obj"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("T")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter"}},[n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("T")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("observe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("obj"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" obj\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 初始化 Vue.options 对象，并给其扩展")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// components/directives/filters")]),s._v("\n  Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("options "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("create")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ASSET_TYPES")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("type")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("create")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// this is used to identify the "base" constructor to extend all plain-object')]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// components with in Weex's multi-instance scenarios.")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// 这是用来标识 "base "构造函数，在Weex的多实例方案中，用它来扩展所有普通对象组件')]),s._v("\n  Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("_base "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Vue\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 设置 keep-alive 组件")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("extend")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("components"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" builtInComponents"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 注册 Vue.use() 用来注册插件")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initUse")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 注册 Vue.mixin() 实现混入")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initMixin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 注册 Vue.extend() 基于传入的options返回一个组件的构造函数")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initExtend")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 注册 Vue.directive()、Vue.component()、Vue.filter()")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initAssetRegisters")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br")])]),n("h3",{attrs:{id:"vue-实例成员初始化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue-实例成员初始化"}},[s._v("#")]),s._v(" Vue 实例成员初始化")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/src/core/instance/index.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("src/core/instance/index.js"),n("OutboundLink")],1),s._v(" "),n("ul",[n("li",[s._v("定义 Vue 的构造函数")]),s._v(" "),n("li",[s._v("初始化 Vue 的实例成员\n"),n("ul",[n("li",[s._v("initMixin() : "),n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/src/core/instance/init.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("src/core/instance/init.js"),n("OutboundLink")],1)]),s._v(" "),n("li",[s._v("stateMixin() : "),n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/src/core/instance/state.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("src/core/instance/state.js"),n("OutboundLink")],1)]),s._v(" "),n("li",[s._v("eventsMixin() : "),n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/src/core/instance/state.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("src/core/instance/state.js"),n("OutboundLink")],1)]),s._v(" "),n("li",[s._v("lifecycleMixin() : "),n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/src/core/instance/state.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("src/core/instance/state.js"),n("OutboundLink")],1)]),s._v(" "),n("li",[s._v("renderMixin() : "),n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/src/core/instance/state.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("src/core/instance/state.js"),n("OutboundLink")],1)])])]),s._v(" "),n("li",[s._v("可参考 "),n("a",{attrs:{href:"https://cn.vuejs.org/v2/api/#%E5%AE%9E%E4%BE%8B-property",target:"_blank",rel:"noopener noreferrer"}},[s._v("Vue 实例 文档"),n("OutboundLink")],1)])])])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 此处不用 class 的原因是因为方便后续给 Vue 实例混入实例成员")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("Vue")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("options")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NODE_ENV")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'production'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("instanceof")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Vue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("warn")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Vue is a constructor and should be called with the `new` keyword'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 调用 _init() 方法")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("_init")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 注册 vm 的 _init() 方法，初始化 vm")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initMixin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 注册 vm 的 $data/$props/$set/$delete/$watch")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("stateMixin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 初始化事件相关方法")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// $on/$once/$off/$emit")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("eventsMixin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 初始化生命周期相关的混入方法")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// _update/$forceUpdate/$destroy")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("lifecycleMixin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 混入 render")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// $nextTick/_render")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("renderMixin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br")])]),n("h3",{attrs:{id:"实例成员-init"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#实例成员-init"}},[s._v("#")]),s._v(" 实例成员 - init")]),s._v(" "),n("ul",[n("li",[s._v("initMixin(Vue)\n"),n("ul",[n("li",[s._v("注册 vm 的 _init() 方法，初始化 vm")]),s._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/src/core/instance/init.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("src/core/instance/init.js"),n("OutboundLink")],1)]),s._v(" "),n("li",[s._v("可参考 "),n("a",{attrs:{href:"https://cn.vuejs.org/v2/api/#%E5%AE%9E%E4%BE%8B-property",target:"_blank",rel:"noopener noreferrer"}},[s._v("Vue 实例 文档"),n("OutboundLink")],1)])])])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initMixin")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("Vue"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Class"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Component"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 给 Vue 实例增加 _init() 方法")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 合并 options / 初始化操作")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Vue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("prototype"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("_init")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("options"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Object")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" vm"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Component "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// a uid")]),s._v("\n    vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("_uid "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" uid"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" startTag"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" endTag\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* istanbul ignore if */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NODE_ENV")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'production'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" config"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("performance "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" mark"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      startTag "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("vue-perf-start:")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("_uid"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),s._v("\n      endTag "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("vue-perf-end:")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("_uid"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mark")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("startTag"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// a flag to avoid this being observed")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 如果是 Vue 实例不需要被 observe")]),s._v("\n    vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("_isVue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// merge options")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 合并 options")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("options "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("_isComponent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// optimize internal component instantiation")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// since dynamic options merging is pretty slow, and none of the")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// internal component options needs special treatment.")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 优化内部组件实例化，因为动态选项合并非常慢，而且内部组件选项都不需要特殊处理。")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initInternalComponent")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("$options "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mergeOptions")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolveConstructorOptions")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("constructor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        options "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        vm\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* istanbul ignore else */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NODE_ENV")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'production'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initProxy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("_renderProxy "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" vm\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// expose real self")]),s._v("\n    vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("_self "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" vm\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// vm 的生命周期相关变量初始化")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// $children/$parent/$root/$refs")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initLifecycle")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// vm 的事件监听初始化, 父组件绑定在当前组件上的事件")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initEvents")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// vm 的编译render初始化")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// $slots/$scopedSlots/_c/$createElement/$attrs/$listeners")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initRender")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// beforeCreate 生命钩子的回调")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("callHook")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'beforeCreate'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 把 inject 的成员注入到 vm 上")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initInjections")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// resolve injections before data/props")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 初始化 vm 的 _props/methods/_data/computed/watch")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initState")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 初始化 provide")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initProvide")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// resolve provide after data/props")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// created 生命钩子的回调")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("callHook")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'created'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* istanbul ignore if */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NODE_ENV")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'production'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" config"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("performance "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" mark"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("_name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("formatComponentName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mark")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("endTag"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("measure")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("vue ")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("_name"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v(" init")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" startTag"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" endTag"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 调用 $mount() 挂载")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("$options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("$mount")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("$options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br")])]),n("h3",{attrs:{id:"实例成员-initstate"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#实例成员-initstate"}},[s._v("#")]),s._v(" 实例成员 - initState")]),s._v(" "),n("ul",[n("li",[s._v("initState(vm)\n"),n("ul",[n("li",[s._v("初始化 vm 的 _props/methods/_data/computed/watch")]),s._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/src/core/instance/state.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("src/core/instance/state.js"),n("OutboundLink")],1)]),s._v(" "),n("li",[s._v("可参考 "),n("a",{attrs:{href:"https://cn.vuejs.org/v2/api/#%E5%AE%9E%E4%BE%8B-property",target:"_blank",rel:"noopener noreferrer"}},[s._v("Vue 实例 文档"),n("OutboundLink")],1)])])])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initState")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("vm"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Component")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("_watchers "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" opts "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("$options\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 将props成员转换成响应式数据，并注入到vue实例")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("props"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initProps")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("props"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 初始化选项中的方法(methods)")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("methods"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initMethods")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("methods"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 数据的初始化")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 把data中的成员注入到Vue实例 并转换为响应式对象")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// observe数据的响应式处理")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("observe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("_data "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* asRootData */")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("computed"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initComputed")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("computed"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("watch "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("watch "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!==")]),s._v(" nativeWatch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initWatch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("watch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])]),n("h3",{attrs:{id:"初始化过程调试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#初始化过程调试"}},[s._v("#")]),s._v(" 初始化过程调试")]),s._v(" "),n("ul",[n("li",[s._v("初始化过程"),n("a",{attrs:{href:"https://github.com/shiguanghai/vue/tree/dev/examples/03-initVue/index.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("调试代码"),n("OutboundLink")],1)])]),s._v(" "),n("p",[n("strong",[s._v("设置断点")]),s._v(":")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("断点1：ssrc/core/instance/index.js\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/202012101712459.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("断点2：src/core/index.js\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210171416950.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("断点3：src/platforms/web/runtime/index.js\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210171628529.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("断点4：src/platforms/web/entry-runtime-with-compiler.js\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210171842446.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])])]),s._v(" "),n("p",[n("strong",[s._v("开始调试")]),s._v(":")]),s._v(" "),n("ul",[n("li",[s._v("F5 进入断点")]),s._v(" "),n("li",[s._v("首先进入"),n("code",[s._v("core/instance/index.js")]),s._v("，它是与平台无关的，在这里调用了Mixin的一些函数，这些函数里面给Vue的原型上增加了一些实例成员")]),s._v(" "),n("li",[s._v("此时我们来监视这些函数执行完毕后Vue身上发生的一些变化\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210173112595.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),n("li",[s._v("F10 跳过函数 initMixin，新增_init()\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210173433857.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),n("li",[s._v("继续，跳过函数 stateMixin()，新增 $data / $props / $set / $delete / $watch 几个成员。但是 $data 和 $props 此时都是 undefined，仅仅初始化了这两个属性，将来需要通过选项去赋值\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210173807530.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),n("li",[s._v("接下来调用函数 eventsMixin()，初始化事件相关的四个方法 $on / $once / $off / $emit\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210174440813.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),n("li",[s._v("再调用函数 lifecycleMixin()，它注册了根生命周期相关的方法 _update / $forceUpdate / $destroy。其中_updata内部调用了 patch 方法，把 VNode 渲染成真实的 DOM\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210175020573.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),n("li",[s._v("最后调用函数renderMixin()，其执行过后，会给原型挂载一些 _开头的方法，这些方法的作用是当我们把模板转换成 render函数的时候，在render函数中调用，除此之外还注册了 $nextTick /_render, _render的作用是调用用户定义 或 模板渲染的render函数\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210175640380.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),n("li",[s._v("F8 跳转到下一个导出Vue的文件"),n("code",[s._v("core/index.js")]),s._v("，这个文件中执行了 initGlobalAPI()，给Vue的构造函数初始化了静态成员\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210175848447.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),n("li",[s._v("F11进入 initGlobalAPI()，F10执行到初始化 Vue.config 对象的地方，Vue的构造函数新增 config属性，这是一个对象，并且这个对象已经初始化了很多内容，这些内容是通过给config对象增加一个get方法，在get方法中返回了"),n("code",[s._v("../config")]),s._v("中导入的config\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210180830750.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),n("li",[s._v("继续F10执行三个静态方法 set / delete / nextTick\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210180952531.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),n("li",[s._v("F10 初始化 observable\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210181622787.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),n("li",[s._v("继续F10 初始化 options对象，但此时options对象为空，因为是通过Object.create(null)来初始化的，没有原型，继续F10 增添全局组件、指令以及过滤器 components / directives / filters，再F10初始化_base即Vue\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210182105899.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),n("li",[s._v("F10为options.compents设置keep-alive组件\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210182231433.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),n("li",[s._v("F10 初始化静态方法 Vue.use()、Vue.mixin()、Vue.extend()。以及Vue.directive()、Vue.component()、Vue.filter()，它们是用来注册全局的指令、组件和过滤器，我们调用这些方法的时候，它们会把指令、组件和过滤器分别帮我们注册到Vue.options中对应的属性里面来\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210183122739.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),n("li",[s._v("再按F8进入"),n("code",[s._v("platforms/web/runtime/index.js")]),s._v("，此时我们看到的代码都是与平台相关的，它首先给Vue.config中注册了一些与平台相关的一些公共的方法，当它执行完过后 又注册了几个与平台相关的指令和组件\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/2020121018412182.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),n("li",[s._v("F10将其执行完观察指令和组件的变化\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210184422488.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),n("li",[s._v("继续F10给Vue原型上注册了patch和$mount，其执行是在Vue._init中调用的\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210184845819.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),n("li",[s._v("F8 进入到最后一个文件"),n("code",[s._v("platforms/web/runtime/entry-runtime-with-compiler.js")]),s._v("的断点，这个文件重写了$mount，新增了把模板编译成render函数的功能\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210185244457.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),n("li",[s._v("在文件最后给Vue构造函数挂载了compile方法，这个方法的作用是让我们手共把模板转换成render函数\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/2020121018542615.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("h2",{attrs:{id:"_4-3-vue首次渲染"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-vue首次渲染"}},[s._v("#")]),s._v(" 4.3 Vue首次渲染")]),s._v(" "),n("h3",{attrs:{id:"首次渲染过程调试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#首次渲染过程调试"}},[s._v("#")]),s._v(" 首次渲染过程调试")]),s._v(" "),n("ul",[n("li",[s._v("Vue 初始化完毕，开始真正的执行")]),s._v(" "),n("li",[s._v("调用 new Vue() 之前，已经初始化完毕")]),s._v(" "),n("li",[s._v("通过调试"),n("a",{attrs:{href:"https://github.com/shiguanghai/vue/blob/dev/examples/03-initVue/index.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("代码"),n("OutboundLink")],1),s._v("，记录首次渲染过程")])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210222319829.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),n("p",[n("strong",[s._v("开始调试")]),s._v(":")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("F8 跳过初始化阶段，进入新增断点\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210222517378.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("F11进入_init()，来到initMixin()，F10来到合并options的位置判断是否为组件，当前为创建Vue实例，并不是组件，进入else\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210222919315.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("合并options：将用户传递进来的options和构造函数中的options进行合并\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210223536985.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("F11 进入initProxy，函数中先判断当前浏览器是否支持Proxy代理对象，如果支持，通过Proxy代理Vue实例，如果不支持代理对象，直接将Vue实例设置给_renderProxy\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210223853972.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("F10执行完毕，继续往下执行一些init，给Vue实例挂载一些成员，先不去调试，我们将断点设置到后面$mount处，F8执行到断点处\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210224134775.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("F11进入$mount()函数\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210224710559.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("F10 获取Vue实例的options选项，判断是否有render函数，没有render获取选项中的template\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210225057825.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("判断template是否存在，当前项目只传入了el和data，template为undefined\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210225241530.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("F10进入else，选项中没有设置模板，判断是否有el，有el调用getOuterHTML()函数\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210225754480.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("F11进入函数getOuterHTML()，函数内部判断是否有outerHTML属性，有的话直接作为模板返回，没有的话说明此时的el不是DOM元素（文本节点/注释节点），此时会创建一个div，把el克隆一份添加到container中，最终将innerHTML返回作为模板\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210225839455.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("F10 返回el(#app)内部的模板\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210230203984.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("F10往下开始编译（将模板编译成render函数），先不去观察如何执行\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210230516357.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("render函数生成，将其存储到options.render选项中，同时还存储了staticRenderFns\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210230728225.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("F10最终执行mount方法，此处的mount()是在"),n("code",[s._v("platforms/web/runtime/index.js")]),s._v("中定义的$mount，我们在入口文件重写了$mount\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210231131844.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("F11进入，此文件会重新获取el(当执行带编译器的Vue，已经获取过el，但是如果此时执行的是运行版本的Vue就不会执行)\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210231646710.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("F11调用mountCompoent()，与浏览器无关，也是Vue的核心代码\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210231925791.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("F10首先判断选项中是否有render函数，如果有且此时为运行时版本则会警告"),n("code",[s._v("运行时版本不支持编译器")]),s._v("，此时为带编译器版本，未手动传入render，但是编译器已经帮我们编译过了\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210232345606.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("下面调用一个生命周期的beforeMount钩子函数，F10接下来挂载(更新组件)，updateComponent将虚拟DOM传递给_update()转化为真实DOM\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201210232530310.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("F10此函数执行完，我们就可以看到将模板渲染到界面上，但是此时只是定义，并未执行。接下来创建Watcher对象，并传递进来updateComponent，其执行是在Watcher()中调用的，我们在此处设置一个断点\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201211184357378.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("F11进入断点，看Watcher具体做了哪些事情，构造函数内传入了几个参数：第一个参数是Vue的实例，第二个参数是updateComponent（可以是字符串/函数，此处传入的为函数），"),n("strong",[s._v("Vue中的Watcher有三种：1.渲染Watcher(当前)，2.计算属性Watcher，3.侦听器Watcher")]),s._v("，最后一个参数isRenderWatcher是否是渲染Watcher，此处为true\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201211184536540.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("构造函数内部还定义了许多属性，此处的"),n("code",[s._v("this.lazy = !!options.lazy")]),s._v("为延时执行的意思，因为Watcher要更新视图，lazy意思是是否延迟更新视图，而我们当前是首次渲染，我们要立即更新，所以此处指为false，而如果此处为计算属性Wather，它会延迟执行，因为在计算属性中，当数据变化之后才去更新视图\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201211185732880.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("F10接下来要判断expOrFn，也就是钩子函数中的第二个参数，它是function或者string，如果是function直接把变量赋给getter，如果是string需要进一步处理（创建侦听器再说）。当前getter中存储的是updateComponent也就是首次渲染时的值\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201211190106817.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("F10接下来要给this.value赋值，它会首先判断this.lazy，如果当前lazy的值是false也就是不延迟执行的话，会立即执行this.get方法\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201211190518264.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("F11来查看get做了哪些事情，首先pushTarget把当前的Watcher对象存入栈中（每一个组件都会对应一个Watcher，Watcher会去渲染视图，如果组件有嵌套会先渲染内部的组件，所以要把父组件对应的Watcher保存）\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201211190743392.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("F10接下里调用了刚刚存储的getter（也就是updateComponent），因此在get内部调用了updateComponent，并且改变了函数内部this的指向，指向Vue的实例并传入vm。"),n("strong",[s._v("最终我们找到了调用updateComponent的位置")]),s._v(" "),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201211191111654.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("接下来我们再按F11就会进入updateComponent里面\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201211191249648.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("此时就会调用_render和_update两个方法，这两个方法执行完毕，就会将模板渲染到界面，点击F10\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201211191556945.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("此时我们看到视图渲染完毕，按F10将Watcher执行完毕回到"),n("code",[s._v("lifecycle.js")]),s._v("，再按F10让其执行完毕\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201211191740367.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}}),s._v(" "),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/2020121119181272.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}}),s._v(" "),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201211191824751.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}}),s._v(" "),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201211191853177.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("最后回到Vue构造函数\n"),n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201211191923675.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),s._v(" "),n("li",[n("p",[s._v("以上就是首次渲染的一个过程")])])]),s._v(" "),n("h3",{attrs:{id:"首次渲染总结"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#首次渲染总结"}},[s._v("#")]),s._v(" 首次渲染总结")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201205195820451.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])])}),[],!1,null,null,null);t.default=e.exports}}]);