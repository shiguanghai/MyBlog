(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{540:function(s,a,n){"use strict";n.r(a);var t=n(1),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"centos-8"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#centos-8"}},[s._v("#")]),s._v(" CentOS 8")]),s._v(" "),n("h3",{attrs:{id:"centos-8-下载镜像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#centos-8-下载镜像"}},[s._v("#")]),s._v(" CentOS 8 下载镜像")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://mirrors.aliyun.com/centos/8/isos/x86_64/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://mirrors.aliyun.com/centos/8/isos/x86_64/"),n("OutboundLink")],1)])]),s._v(" "),n("h3",{attrs:{id:"宿主机配置-host"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#宿主机配置-host"}},[s._v("#")]),s._v(" 宿主机配置 Host")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看虚拟机中的 IP")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip")]),s._v(" addr\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("C:\\Windows\\System32\\drivers\\etc\\hosts")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".137.129 lfz.com\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"无法上网"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#无法上网"}},[s._v("#")]),s._v(" 无法上网")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /etc/sysconfig/network-scripts/\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" ifcfg-ens33\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("BOOTPROTO")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("dhcp "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将dhcp修改为static表示使用静态ip")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ONBOOT")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yes "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将no改为yes")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启网卡")]),s._v("\nnmcli c reload ifcfg-ens33\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("ul",[n("li",[s._v("给虚拟机的网卡共享本地连接")])]),s._v(" "),n("h3",{attrs:{id:"配置-ssh-key-免密登陆"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置-ssh-key-免密登陆"}},[s._v("#")]),s._v(" 配置 ssh-key 免密登陆")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" C:"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Administrator"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(".ssh\nssh-keygen\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 客户机配置 config")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# centos服务器上配置公钥")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h2",{attrs:{id:"docker-简介"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-简介"}},[s._v("#")]),s._v(" Docker 简介")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://docs.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://docs.docker.com/"),n("OutboundLink")],1)])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("docker run --name nginx-test -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(":80 -d nginx\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("docker run --rm -d -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("40001")]),s._v(":3000 jayfong/yapi:play\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认的管理员账号：admin@docker.yapi，管理员密码：adm1n")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"什么是-docker"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#什么是-docker"}},[s._v("#")]),s._v(" 什么是 Docker")]),s._v(" "),n("ul",[n("li",[s._v("Docker 是一个集打包、运行、测试、发布于一体的开放式平台")]),s._v(" "),n("li",[s._v("我们可以把开发过程中的基础设施分离出来部署到 Docker\n"),n("ul",[n("li",[s._v("DevOps：开发、构建、自动化部署、测试、文档")]),s._v(" "),n("li",[s._v("GitLib、Jenkins")]),s._v(" "),n("li",[s._v("Nginx、Apache")]),s._v(" "),n("li",[s._v("MySQL、MongoDb")]),s._v(" "),n("li",[s._v("文档管理工具")])])]),s._v(" "),n("li",[s._v("使用 Docker 可以避免复杂的应用环境配置，并以秒级的速度开启")]),s._v(" "),n("li",[s._v("支持绝大多数平台，容器的性能开销极低")])]),s._v(" "),n("h3",{attrs:{id:"docker-应用场景"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-应用场景"}},[s._v("#")]),s._v(" Docker 应用场景")]),s._v(" "),n("ul",[n("li",[s._v("Web 应用的自动化打包和发布")]),s._v(" "),n("li",[s._v("自动化测试和持续集成、发布")]),s._v(" "),n("li",[s._v("在服务型环境中部署和调整数据库或其他的后台应用")])]),s._v(" "),n("h3",{attrs:{id:"docker-核心概念"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-核心概念"}},[s._v("#")]),s._v(" Docker 核心概念")]),s._v(" "),n("ul",[n("li",[s._v("Docker Daemon 守护进程\n"),n("ul",[n("li",[s._v("Docker Daemon 是 Docker 的守护进程")]),s._v(" "),n("li",[s._v("Docker Client 通过命令行与 Docker Daemon 通信完成 Docker 相关操作")])])]),s._v(" "),n("li",[s._v("Docker Client 客户端\n"),n("ul",[n("li",[s._v("通过终端和用户交互")]),s._v(" "),n("li",[s._v("终端中输入指令，Docker 客户端把指令传递给 Docker Daemon")])])]),s._v(" "),n("li",[s._v("Docker Image 镜像\n"),n("ul",[n("li",[s._v("可以认为是一个最小版本的 Linux 系统的镜像，包含了所需的文件系统和一些配置好的应用")]),s._v(" "),n("li",[s._v("需要通过容器来加载镜像")]),s._v(" "),n("li",[s._v("是静态的，可以和面向对象中类对比")])])]),s._v(" "),n("li",[s._v("Docker Container 容器\n"),n("ul",[n("li",[s._v("通过镜像创建一个容器")]),s._v(" "),n("li",[s._v("可以创建多个容器，每一个容器都会开启一个进程，多个容器之间是相互隔离的")]),s._v(" "),n("li",[s._v("是动态的，可以和面向对象的实例对比")])])])]),s._v(" "),n("h3",{attrs:{id:"docker-体系结构"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-体系结构"}},[s._v("#")]),s._v(" Docker 体系结构")]),s._v(" "),n("ul",[n("li",[s._v("Docker 使用客户端-服务器 (C/S) 架构模式，使用远程 API 来管理和创建 Docker 容器")])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/2020122913253891.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70#pic_center",alt:"在这里插入图片描述"}})]),s._v(" "),n("h3",{attrs:{id:"docker-和虚拟机的区别"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-和虚拟机的区别"}},[s._v("#")]),s._v(" Docker 和虚拟机的区别")]),s._v(" "),n("ul",[n("li",[s._v("虚拟机是硬件级虚拟化，每一个虚拟机内部都要分割系统资源，需要虚拟出虚拟硬件")]),s._v(" "),n("li",[s._v("Docker 是系统级虚拟化，容器共享系统资源，不会虚拟出硬件")])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/2020122913262022.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70#pic_center",alt:"在这里插入图片描述"}})]),s._v(" "),n("ul",[n("li",[s._v("官网的说明\n"),n("ul",[n("li",[n("a",{attrs:{href:"https://www.docker.com/resources/what-container",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.docker.com/resources/what-container"),n("OutboundLink")],1)])])]),s._v(" "),n("li",[s._v("容器技术和虚拟机区别")])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201229132807990.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70#pic_center",alt:"在这里插入图片描述"}})]),s._v(" "),n("h2",{attrs:{id:"安装-docker"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装-docker"}},[s._v("#")]),s._v(" 安装 Docker")]),s._v(" "),n("h3",{attrs:{id:"参考文档"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考文档"}},[s._v("#")]),s._v(" 参考文档")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://docs.docker.com/install/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://docs.docker.com/install/"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://www.runoob.com/docker/centos-docker-install.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.runoob.com/docker/centos-docker-install.html"),n("OutboundLink")],1)])]),s._v(" "),n("h3",{attrs:{id:"安装步骤"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装步骤"}},[s._v("#")]),s._v(" 安装步骤")]),s._v(" "),n("p",[s._v("下面演示 Centos 中的安装步骤，其他系统中可以参考文档")]),s._v(" "),n("ul",[n("li",[s._v("删除旧版本的 Docker")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("yum remove docker "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                docker-client "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                docker-client-latest "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                docker-common "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                docker-latest "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                docker-latest-logrotate "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                docker-logrotate "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                docker-engine\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("ul",[n("li",[s._v("添加可以获取到 Docker 的源")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("dnf config-manager --add-repo"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("https://download.docker.com/linux/centos/docker-ce.repo\n\ndnf config-manager --add-repo"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("ul",[n("li",[s._v("安装 Docker 社区版\n"),n("ul",[n("li",[s._v("CentOS 8")])])])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("yum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" https://download.docker.com/linux/centos/8/x86_64/stable/Packages/containerd.io-1.4.3-3.1.el8.x86_64.rpm\n\nyum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce docker-ce-cli\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("ul",[n("li",[s._v("CentOS 7\n"),n("ul",[n("li",[s._v("安装依赖项")])])])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("yum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y yum-utils "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  device-mapper-persistent-data "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  lvm2\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("yum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce docker-ce-cli containerd.io\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ul",[n("li",[s._v("启动和停止 Docker")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("systemctl start docker\nsystemctl stop docker\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开机启动")]),s._v("\nsystemctl "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" docker\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 立即运行并开机启动")]),s._v("\nsystemctl "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" --now docker\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("ul",[n("li",[s._v("跑一个 Hello world")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("docker run hello-world\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. Docker client 连接 Docker daemon")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. Docker daemon 从 Docker Hub 拉取'hello world'的镜像")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3. Docker daemon 基于拉取的镜像创建一个容器")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4. Docker daemon 将容器中的应用执行的结果发送给 Docker client，并打印到终端")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h3",{attrs:{id:"镜像加速"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#镜像加速"}},[s._v("#")]),s._v(" 镜像加速")]),s._v(" "),n("p",[s._v("Docker 获取镜像的时候，默认从 Docker hub 获取，服务器在国外所以国内下载会很慢，我们可以设置成国内的镜像地址，类似于 npm")]),s._v(" "),n("ul",[n("li",[s._v("参考文档\n"),n("ul",[n("li",[n("a",{attrs:{href:"https://www.runoob.com/docker/docker-mirror-acceleration.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.runoob.com/docker/docker-mirror-acceleration.html"),n("OutboundLink")],1)])])]),s._v(" "),n("li",[s._v("常用的国内镜像地址\n"),n("ul",[n("li",[n("a",{attrs:{href:"https://docker.mirrors.ustc.edu.cn",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://docker.mirrors.ustc.edu.cn"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://almtd3fa.mirror.aliyuncs.com",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://almtd3fa.mirror.aliyuncs.com"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://registry.docker-cn.com",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://registry.docker-cn.com"),n("OutboundLink")],1)])])]),s._v(" "),n("li",[s._v("获取镜像的时候，指定地址")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("docker run hello-world --registry-mirror"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("https://docker.mirrors.ustc.edu.cn\n\ndocker run hello-world --registry-mirror"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("https://almtd3fa.mirror.aliyuncs.com\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("ul",[n("li",[s._v("配置中设置镜像地址\n"),n("ul",[n("li",[s._v("在 /etc/docker/daemon.json 文件中设置以下内容")])])])]),s._v(" "),n("div",{staticClass:"language-json line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"registry-mirrors"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://almtd3fa.mirror.aliyuncs.com"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://registry.docker-cn.com"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ul",[n("li",[s._v("重启服务")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("systemctl daemon-reload\nsystemctl restart docker\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h2",{attrs:{id:"docker-基本使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-基本使用"}},[s._v("#")]),s._v(" Docker 基本使用")]),s._v(" "),n("h3",{attrs:{id:"docker-镜像使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-镜像使用"}},[s._v("#")]),s._v(" Docker 镜像使用")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://www.runoob.com/docker/docker-repository.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.runoob.com/docker/docker-repository.html"),n("OutboundLink")],1)]),s._v(" "),n("li",[s._v("通过 Docker Hub 网站查找镜像\n"),n("ul",[n("li",[n("a",{attrs:{href:"https://hub.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://hub.docker.com/"),n("OutboundLink")],1)])])]),s._v(" "),n("li",[s._v("常用命令")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看本地镜像")]),s._v("\ndocker images\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取一个镜像")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果指定镜像版本 centos:latest, 默认就是最新版本")]),s._v("\ndocker pull centos\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除镜像")]),s._v("\ndocker rmi hello-world\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 为镜像设置一个新的 tag")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# image id -> 860c279d2fec")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 镜像的用户名 -> lfz")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 镜像名称 -> centos")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tag -> dev")]),s._v("\ndocker tag 860c279d2fec lfz/centos:dev\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("h3",{attrs:{id:"容器使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#容器使用"}},[s._v("#")]),s._v(" 容器使用")]),s._v(" "),n("ul",[n("li",[s._v("使用镜像创建一个容器")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以 centos 镜像启动一个容器")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 参数说明: -i 交互式操作，-t 终端，centos 镜像名称，/bin/bash 镜像运行以后执行的命令 打开终端 ")]),s._v("\ndocker run -it centos /bin/bash\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不同镜像的用户是不一样的，启动镜像的参数也不同")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 参数说明：-d 后台运行，--name nginx-server 容器的名字")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 说明：-p 映射容器中的端口，宿主机端口:容器端口，nginx 镜像名称")]),s._v("\ndocker run -d --name nginx-server -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(":80 nginx\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("ul",[n("li",[s._v("常用命令")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看所有容器")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不加参数 -a 查看所有运行中的容器")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -a\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看运行中容器的状态")]),s._v("\ndocker stats \n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动容器，参数可以是容器id，或者容器名称")]),s._v("\ndocker start nginx-server\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止、重启、删除容器")]),s._v("\ndocker stop nginx-serve\ndocker restart nginx-serve\ndocker "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f nginx-serve\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 清理所有终止的容器")]),s._v("\ndocker container prune\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入容器")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it nginx-server /bin/bash\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看容器内部的日志")]),s._v("\ndocker logs -f nginx-server\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br")])]),n("ul",[n("li",[s._v("导入和导出容器")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 导出容器，导出容器的快照文件")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" nginx-server "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" nginx-server.tar\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 导入容器快照 - 从快照文件中导入镜像  mynginx 镜像名称，v1 镜像的 tag")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" docker/nginx-server.tar "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" docker "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("import")]),s._v(" - mynginx:v1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h2",{attrs:{id:"安装-yapi"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装-yapi"}},[s._v("#")]),s._v(" 安装 yapi")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://hub.docker.com/r/jayfong/yapi",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://hub.docker.com/r/jayfong/yapi"),n("OutboundLink")],1)]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("docker run --rm -d -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("40001")]),s._v(":3000 jayfong/yapi:play\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认的管理员账号：admin@docker.yapi，管理员密码：adm1n。")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h2",{attrs:{id:"安装-nginx-镜像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装-nginx-镜像"}},[s._v("#")]),s._v(" 安装 nginx 镜像")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://www.runoob.com/docker/docker-install-nginx.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.runoob.com/docker/docker-install-nginx.html"),n("OutboundLink")],1)]),s._v(" "),n("h2",{attrs:{id:"常用-docker-命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#常用-docker-命令"}},[s._v("#")]),s._v(" 常用 Docker 命令")]),s._v(" "),n("ul",[n("li",[s._v("镜像操作")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用镜像开启一个容器,并进入容器 -it 交互式终端操作")]),s._v("\ndocker run -it nginx /bin/bash \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用镜像开启一个容器, 后台运行  ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 参数说明：--name nginx-test 容器名字  -p 端口映射  -d nginx 后台运行镜像名字")]),s._v("\ndocker run --name nginx-test -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(":80 -d nginx\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 镜像删除")]),s._v("\ndocker rmi nginx:test\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("ul",[n("li",[s._v("容器操作")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在容器中执行命令")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it nginx-test /bin/bash \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动停止")]),s._v("\ndocker start bb0d52be2f81\ndocker stop bb0d52be2f81\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" bb0d52be2f81\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 清理所有终止的容器")]),s._v("\ndocker container prune\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h2",{attrs:{id:"容器部署-vue-js-项目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#容器部署-vue-js-项目"}},[s._v("#")]),s._v(" 容器部署 Vue.js 项目")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://cn.vuejs.org/v2/cookbook/dockerize-vuejs-app.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://cn.vuejs.org/v2/cookbook/dockerize-vuejs-app.html"),n("OutboundLink")],1)])]),s._v(" "),n("h3",{attrs:{id:"dockerfile"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[s._v("#")]),s._v(" Dockerfile")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://docs.docker.com/engine/reference/builder/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://docs.docker.com/engine/reference/builder/"),n("OutboundLink")],1)]),s._v(" "),n("li",[s._v("创建 Docker 镜像")]),s._v(" "),n("li",[s._v("Docker 镜像的配置文件")])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201229133424113.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTQ5MjU2,size_16,color_FFFFFF,t_70#pic_center",alt:"在这里插入图片描述"}})]),s._v(" "),n("ul",[n("li",[s._v("Dockerfile")])]),s._v(" "),n("div",{staticClass:"language-dockerfile line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# build stage")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" node"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("lts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("alpine as build"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("stage\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" /app\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" package*.json ./\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" npm install "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("registry=https"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//registry.npm.taobao.org \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" . .\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" npm run build\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# production stage")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("stable"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("alpine as production"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("stage\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("from=build"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("stage /app/dist /usr/share/nginx/html\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 80\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-g"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"daemon off;"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("ul",[n("li",[s._v("使用 Dockerfile")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("docker build --rm -t deploy-web:v1.0 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编译过程中如果遇到 npm install 的时候无法解析 npm 的地址，可以使用宿主机的 network")]),s._v("\ndocker network "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\ndocker build --network "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" --rm -t deploy-web:v1.0 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开启容器")]),s._v("\ndocker run -itd --name web -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("88")]),s._v(":80 deploy-web:v1.0\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("ul",[n("li",[s._v("在浏览器中测试")])]),s._v(" "),n("h3",{attrs:{id:"docker-hub"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-hub"}},[s._v("#")]),s._v(" Docker Hub")]),s._v(" "),n("ul",[n("li",[s._v("私有仓库 Harbor")]),s._v(" "),n("li",[s._v("公共仓库 "),n("a",{attrs:{href:"https://hub.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://hub.docker.com/"),n("OutboundLink")],1),s._v(" "),n("ul",[n("li",[s._v("首先登陆到 Docker Hub")])])])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("docker login\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从容器创建一个新的镜像")]),s._v("\ndocker commit a6a685eb4ba1 goddlts/web:v1.1\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 镜像上传到 hub")]),s._v("\ndocker push goddlts/web\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h3",{attrs:{id:"映射配置目录和网站根目录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#映射配置目录和网站根目录"}},[s._v("#")]),s._v(" 映射配置目录和网站根目录")]),s._v(" "),n("ul",[n("li",[s._v("映射配置目录和网站根目录")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 复制之前容器中的 nginx 配置文件，把容器中的配置目录nginx拷贝到当前目录下")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" web:/etc/nginx "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("docker run -itd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --name web-web "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --volume /home/mypro:/usr/share/nginx/html "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --volume /home/nginx:/etc/nginx "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("89")]),s._v(":80 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  deploy-web:v1.0\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 更改权限")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" -R "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("777")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h2",{attrs:{id:"gitlab"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#gitlab"}},[s._v("#")]),s._v(" Gitlab")]),s._v(" "),n("h3",{attrs:{id:"安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://about.gitlab.com/install/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://about.gitlab.com/install"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://docs.gitlab.com/omnibus/docker/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://docs.gitlab.com/omnibus/docker"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://hub.docker.com/r/gitlab/gitlab-ce/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://hub.docker.com/r/gitlab/gitlab-ce"),n("OutboundLink")],1)])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("docker run --detach "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n --hostname "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".137.129 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --publish "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13880")]),s._v(":80 --publish "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13822")]),s._v(":22 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --name gitlab "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --restart always "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -v /home/gitlab/config:/etc/gitlab -v /home/gitlab/logs:/var/log/gitlab -v /home/gitlab/data:/var/opt/gitlab "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  gitlab/gitlab-ce:latest\n\ndocker run --detach "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --hostname lfz.com "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --publish "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13880")]),s._v(":80 --publish "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13822")]),s._v(":22 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --name gitlab "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --restart always "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -v /backup/gitlab/config:/etc/gitlab -v /backup/gitlab/logs:/var/log/gitlab -v /backup/gitlab/data:/var/opt/gitlab "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  gitlab/gitlab-ce:latest\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 防火墙允许端口")]),s._v("\nfirewall-cmd --add-port"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13880")]),s._v("/tcp --permanent\nfirewall-cmd --reload\n\ndocker logs -f gitlab\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])]),n("ul",[n("li",[n("p",[s._v("通过浏览器访问，修改中文界面")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://192.168.137.129:13880/",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://192.168.137.129:13880/"),n("OutboundLink")],1)]),s._v(" "),n("li",[s._v("点击右上角头像 - Settings - Preferences - Localization - Language - Save Changes - 刷新浏览器")])])]),s._v(" "),n("li",[n("p",[s._v("修改 gitlab 显示的端口")])])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /home/gitlab/config/gitlab.rb\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("external_url "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://192.168.137.129:13880'")]),s._v("\nnginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'listen_port'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\ngitlab_rails"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'gitlab_shell_ssh_port'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13822")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("docker restart gitlab\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"关闭防火墙-解决容器内无法解析dns"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#关闭防火墙-解决容器内无法解析dns"}},[s._v("#")]),s._v(" 关闭防火墙（解决容器内无法解析DNS）")]),s._v(" "),n("ul",[n("li",[s._v("关闭容器防火墙")]),s._v(" "),n("li",[s._v("重启 docker")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭防火墙")]),s._v("\nsystemctl stop firewalld\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开机禁用")]),s._v("\nsystemctl disable firewalld\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开机启用")]),s._v("\nsystemctl "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" firewalld\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启 docker")]),s._v("\nsystemctl restart docker\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);